# ü§ù Contributing to Claude Code Template

> **Developer Guide** - How to contribute features, fixes, and improvements to the Claude Code Template

**Quick Links:** [üöÄ Quick Start](QUICK_START.md) | [üìñ User Guide](docs/USER_GUIDE.md) | [‚ú® Best Practices](docs/BEST_PRACTICES.md) | [üîß Troubleshooting](docs/TROUBLESHOOTING.md) | [üè† Home](README.md)

---

## üìë Table of Contents

1. [Introduction](#-introduction)
2. [Getting Started](#-getting-started)
3. [Development Setup](#-development-setup)
4. [Making Changes](#-making-changes)
5. [Testing Requirements](#-testing-requirements)
6. [Documentation Standards](#-documentation-standards)
7. [Pull Request Process](#-pull-request-process)
8. [Versioning Guidelines](#-versioning-guidelines)
9. [Need Help?](#-need-help)
10. [Navigation](#-navigation)

---

## üëã Introduction

Thank you for your interest in contributing to the **Claude Code Template**! This project helps developers create automation projects using Claude Code's hybrid architecture (UX Layer + Orchestrator SDK).

**Why contribute?**
- Your improvements benefit **every project** generated by the template
- Help shape the future of AI-powered automation tools
- Join a community of developers building with Claude Code
- Learn advanced patterns: TDD, context engineering, template systems

**Types of contributions we accept:**

| Contribution Type | Examples | Priority |
|-------------------|----------|----------|
| üêõ **Bug Fixes** | Checkpoint validation errors, template rendering bugs | HIGH |
| ‚ú® **New Features** | New template variables, custom subagents, Jinja2 templates | MEDIUM |
| üìö **Documentation** | Improve guides, add examples, fix typos | MEDIUM |
| üß™ **Test Coverage** | Add unit/integration tests, improve coverage | MEDIUM |
| ‚ö° **Performance** | Optimize context window usage, faster analysis | LOW |

---

## üöÄ Getting Started

### Prerequisites

Before contributing, ensure you have:

- ‚úÖ **Python 3.10+** installed
- ‚úÖ **Git** proficiency (branching, rebasing, pull requests)
- ‚úÖ **GitHub account** for pull requests
- ‚úÖ Familiarity with **Pydantic v2** and **Jinja2** (or willingness to learn)
- ‚úÖ Understanding of **Claude Code** (complete [Quick Start](QUICK_START.md) first)

**Recommended background knowledge:**
- Test-Driven Development (TDD)
- Semantic versioning
- Markdown documentation
- GitHub Actions (for CI/CD)

### First Steps

1. **Read the documentation:**
   - [Quick Start](QUICK_START.md) - Understand the template (10 min)
   - [User Guide](docs/USER_GUIDE.md) - Deep dive into architecture (30 min)
   - [Planning](./claude/PLANNING.md) - Technical architecture details

2. **Explore the codebase:**
   ```bash
   git clone https://github.com/iacorp/claude-code-template.git
   cd claude-code-template

   # Explore structure
   tree -L 2
   ```

3. **Find an issue:**
   - Browse [open issues](https://github.com/iacorp/claude-code-template/issues)
   - Look for `good first issue` or `help wanted` labels
   - Or propose a new feature by opening an issue first

---

## üíª Development Setup

### 1. Fork and Clone

```bash
# Fork the repository on GitHub (click "Fork" button)

# Clone your fork
git clone https://github.com/YOUR_USERNAME/claude-code-template.git
cd claude-code-template

# Add upstream remote (to sync with main repo)
git remote add upstream https://github.com/iacorp/claude-code-template.git

# Verify remotes
git remote -v
# origin    https://github.com/YOUR_USERNAME/claude-code-template.git (your fork)
# upstream  https://github.com/iacorp/claude-code-template.git (main repo)
```

### 2. Install Dependencies

```bash
# Create virtual environment
python3 -m venv venv

# Activate virtual environment
source venv/bin/activate          # macOS/Linux
# or
venv\Scripts\activate             # Windows

# Upgrade pip
pip install --upgrade pip

# Install production dependencies
pip install -r requirements.txt

# Install development dependencies (testing, linting)
pip install -r requirements-dev.txt
# Includes: pytest, pytest-cov, black, ruff, mypy
```

### 3. Environment Configuration

```bash
# Copy environment template
cp .env.example .env

# Edit .env and add your API key
# ANTHROPIC_API_KEY=sk-ant-xxxxx
```

### 4. Verify Setup

```bash
# Run all tests to verify everything works
pytest tests/

# Expected output:
# ==================== 18 passed in 2.5s ====================

# Check code style
black --check orchestrator/ tests/
ruff check orchestrator/

# Run type checking
mypy orchestrator/
```

**If tests fail:**
- Check that virtual environment is activated
- Verify `ANTHROPIC_API_KEY` in `.env`
- See [Troubleshooting](docs/TROUBLESHOOTING.md)

---

## üõ†Ô∏è Making Changes

### 1. Create Feature Branch

Always create a new branch for your changes:

```bash
# Update your main branch first
git checkout main
git pull upstream main

# Create feature branch
git checkout -b feature/add-database-variable

# Branch naming conventions:
# - feature/xxx  ‚Üí New features
# - fix/xxx      ‚Üí Bug fixes
# - docs/xxx     ‚Üí Documentation only
# - refactor/xxx ‚Üí Code refactoring
# - test/xxx     ‚Üí Test improvements
```

### 2. Code Style Guidelines

**Python style (PEP 8 + type hints):**

```python
# ‚úÖ GOOD - Type hints, docstring, clear naming
from typing import Optional, Dict

def analyze_database_type(goal: str) -> Optional[str]:
    """
    Detect database type from goal description.

    Args:
        goal: User's automation goal description

    Returns:
        Database type (postgresql, mongodb, etc.) or None if not detected
    """
    goal_lower = goal.lower()

    if 'postgresql' in goal_lower:
        return 'postgresql'
    elif 'mongodb' in goal_lower:
        return 'mongodb'

    return None


# ‚ùå BAD - No type hints, no docstring, unclear naming
def analyze(g):
    if 'postgresql' in g.lower():
        return 'postgresql'
    return None
```

**Code formatting standards:**

- **Max line length:** 100 characters
- **Imports:** Alphabetical, grouped (stdlib ‚Üí third-party ‚Üí local)
- **Docstrings:** Google style for all public functions
- **Type hints:** Required for all function arguments and return types
- **Comments:** Explain WHY, not WHAT

**Automated formatting:**

```bash
# Format code with Black
black orchestrator/ tests/

# Lint with ruff
ruff check orchestrator/ --fix

# Type check with mypy
mypy orchestrator/
```

### 3. Commit Message Convention

Use [Conventional Commits](https://www.conventionalcommits.org/) format:

```
type(scope): brief description

Detailed explanation if needed.

Fixes #123
```

**Types:**
- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation only
- `refactor`: Code refactoring (no behavior change)
- `test`: Adding or updating tests
- `chore`: Maintenance tasks

**Examples:**

```bash
# Good commit messages:
git commit -m "feat(orchestrator): add database type detection to IntentAnalyzer"
git commit -m "fix(templates): correct Jinja2 variable escaping in README.md.j2"
git commit -m "docs(user-guide): add example for multi-API projects"
git commit -m "test(intent-analyzer): add tests for performance requirement detection"

# Bad commit messages:
git commit -m "fix bug"                    # Too vague
git commit -m "Updated files"              # No context
git commit -m "WIP"                        # Work in progress (shouldn't commit)
```

### 4. Keep Commits Atomic

**One logical change per commit:**

```bash
# ‚úÖ GOOD - Separate commits for separate changes
git commit -m "feat(models): add PerformanceRequirements model"
git commit -m "feat(analyzer): implement performance detection logic"
git commit -m "test(analyzer): add tests for performance detection"

# ‚ùå BAD - Everything in one commit
git commit -m "Add performance detection feature with tests and docs"
```

**Why atomic commits matter:**
- Easier to review
- Easier to revert if needed
- Clearer history
- Tests pass after each commit

---

## üß™ Testing Requirements

### Testing Philosophy

**TDD Approach (mandatory):**

```
1. Write failing test FIRST  (RED)
2. Add fixtures/mocks       (SETUP)
3. Implement minimal code   (IMPLEMENT)
4. Test passes              (GREEN)
5. Verify and commit        (CONFIRM)
```

**Coverage goals:**
- ‚úÖ **New code:** ‚â•90% coverage required
- ‚úÖ **Bug fixes:** Add test that would have caught the bug
- ‚úÖ **Features:** Unit tests + integration tests if needed

### Writing Tests

**Test structure:**

```python
# tests/unit/test_intent_analyzer.py
import pytest
from orchestrator.intent_analyzer import IntentAnalyzer
from orchestrator.models import AutomationIntent

class TestIntentAnalyzer:
    """Tests for IntentAnalyzer class."""

    def test_detect_gmail_api_from_goal(self):
        """Test Gmail API detection from goal description."""
        analyzer = IntentAnalyzer()

        goal = "Automate Gmail to Notion sync every 15 minutes"
        intent = analyzer.analyze_intent(goal)

        assert "Gmail" in [api.name for api in intent.apis_list]
        assert intent.primary_api == "Gmail API"

    def test_detect_multiple_apis(self):
        """Test detection of multiple APIs in goal."""
        analyzer = IntentAnalyzer()

        goal = "Sync Gmail to Notion and send Slack notifications"
        intent = analyzer.analyze_intent(goal)

        assert len(intent.apis_list) == 3
        assert {"Gmail", "Notion", "Slack"}.issubset({api.name for api in intent.apis_list})

    def test_complexity_assessment_simple(self):
        """Test SIMPLE complexity for single API, no auth."""
        analyzer = IntentAnalyzer()

        goal = "Fetch weather from OpenWeatherMap API"
        intent = analyzer.analyze_intent(goal)

        assert intent.complexity_level == "SIMPLE"

    def test_complexity_assessment_medium(self):
        """Test MEDIUM complexity for multiple APIs with OAuth."""
        analyzer = IntentAnalyzer()

        goal = "Automate Gmail to Notion with OAuth authentication"
        intent = analyzer.analyze_intent(goal)

        assert intent.complexity_level == "MEDIUM"
```

**Testing best practices:**

1. **Descriptive test names:** `test_what_is_being_tested_and_expected_outcome`
2. **One assertion per test** (when possible)
3. **Use fixtures for shared setup:**

```python
# tests/conftest.py
import pytest
from orchestrator.intent_analyzer import IntentAnalyzer

@pytest.fixture
def analyzer():
    """Provide IntentAnalyzer instance."""
    return IntentAnalyzer()

@pytest.fixture
def sample_intent():
    """Provide sample AutomationIntent for testing."""
    return AutomationIntent(
        goal_description="Test goal",
        complexity_level="MEDIUM",
        apis_list=[{"name": "Gmail", "version": "v1"}]
    )
```

4. **Mock external dependencies:**

```python
from unittest.mock import Mock, patch

@patch('orchestrator.subagent_manager.subprocess.run')
def test_subagent_execution(mock_subprocess):
    """Test subagent execution without actually running subprocess."""
    mock_subprocess.return_value = Mock(stdout='{"result": "success"}')

    manager = SubagentManager()
    result = manager.run_agent('sequential-thinking', intent)

    assert result['result'] == 'success'
    mock_subprocess.assert_called_once()
```

### Running Tests

```bash
# Run all tests
pytest tests/

# Run with verbose output
pytest tests/ -v

# Run specific test file
pytest tests/unit/test_intent_analyzer.py

# Run specific test
pytest tests/unit/test_intent_analyzer.py::test_detect_gmail_api_from_goal

# Run with coverage report
pytest --cov=orchestrator --cov-report=term-missing tests/

# Expected output:
# Name                             Stmts   Miss  Cover   Missing
# -------------------------------------------------------------
# orchestrator/__init__.py             5      0   100%
# orchestrator/intent_analyzer.py     85      3    96%   145-147
# orchestrator/models.py              42      0   100%
# -------------------------------------------------------------
# TOTAL                              132      3    98%

# Run only fast tests (skip integration)
pytest tests/unit/

# Run integration tests (may require API key)
pytest tests/integration/
```

**Before committing:**

```bash
# ALL tests must pass
pytest tests/

# Coverage for new code ‚â•90%
pytest --cov=orchestrator --cov-report=term tests/
```

---

## üìö Documentation Standards

### When to Update Documentation

**Always update docs when:**

| Change Type | Documentation to Update |
|-------------|------------------------|
| New feature | `README.md`, `docs/USER_GUIDE.md`, `CHANGELOG.md` |
| New template variable | `docs/TEMPLATES.md`, `docs/BEST_PRACTICES.md` |
| Bug fix (common error) | `docs/TROUBLESHOOTING.md`, `CHANGELOG.md` |
| Breaking change | `MIGRATIONS.md`, `CHANGELOG.md`, all affected docs |
| New API support | `docs/USER_GUIDE.md`, `.claude/memories/api_integrations.json` |

### Documentation Style Guide

**Markdown formatting:**

```markdown
# ‚úÖ GOOD

## Section Title

Brief introduction to section.

**Key points:**
- Use bullet lists for multiple items
- Code blocks must specify language: ```python, ```bash
- Include realistic examples, not pseudocode

**Example:**

\`\`\`python
def example_function(param: str) -> Dict:
    """Always include docstrings."""
    return {"result": param}
\`\`\`

**Common pitfall:** Explain what users should avoid.

# ‚ùå BAD

## section title  (no emoji, not capitalized)

Here's some text without structure...

\`\`\`
code without language specified
\`\`\`

Click [here](link.md) to learn more.  (use descriptive link text)
```

**Style conventions:**
- **Headings:** Use emoji for top-level sections: üéØ üìö üõ†Ô∏è ‚ö°
- **Links:** Descriptive text: `[User Guide](USER_GUIDE.md)` not `[here](link)`
- **Code blocks:** Always specify language: ` ```python `, ` ```bash `
- **Examples:** Show complete, working code (not pseudocode)
- **Tone:** Concise, actionable, friendly but professional
- **Navigation:** Every doc must have breadcrumbs at bottom

**Navigation breadcrumbs template:**

```markdown
## üìö Navigation

**Documentation Map:**

\`\`\`
üöÄ QUICK_START.md     ‚Üê Start here
       ‚Üì
üìñ USER_GUIDE.md      ‚Üê Deep dive
       ‚Üì
üîß TROUBLESHOOTING.md ‚Üê Solve issues
       ‚Üì
‚ú® BEST_PRACTICES.md  ‚Üê Optimize
       ‚Üì
ü§ù CONTRIBUTING.md    ‚Üê Contribute (YOU ARE HERE)
\`\`\`

**Quick Links:**
- [üè† Home](README.md)
- [üöÄ Quick Start](QUICK_START.md)
- [üìñ User Guide](docs/USER_GUIDE.md)
- [‚ú® Best Practices](docs/BEST_PRACTICES.md)
- [üîß Troubleshooting](docs/TROUBLESHOOTING.md)
```

### Updating CHANGELOG.md

Follow [Keep a Changelog](https://keepachangelog.com/) format:

```markdown
## [3.1.0] - 2025-01-15

### Added
- New `database_type` variable for template customization (#45)
- `@database-schema-analyzer` subagent for database design (#47)
- Performance requirements detection in IntentAnalyzer (#46)

### Fixed
- Checkpoint validation not saving state correctly (#42)
- Jinja2 variable escaping in README.md.j2 template (#44)

### Changed
- IntentAnalyzer now detects real-time vs async vs batch requirements (#46)
- Improved error messages for template rendering failures (#43)

### Deprecated
- None

### Removed
- None

### Security
- None
```

**CHANGELOG rules:**
- Add entry for **every** user-facing change
- Link to issue/PR: `(#123)`
- Use past tense: "Added", "Fixed", "Changed"
- Update version following semantic versioning

---

## üîÑ Pull Request Process

### Before Opening PR

**Pre-flight checklist:**

```bash
# 1. Ensure all tests pass
pytest tests/

# 2. Check code style
black orchestrator/ tests/
ruff check orchestrator/

# 3. Verify type hints
mypy orchestrator/

# 4. Update from upstream (avoid merge conflicts)
git fetch upstream
git rebase upstream/main

# 5. Push to your fork
git push origin feature/your-feature-name
```

### Opening the Pull Request

**PR template:**

```markdown
## What

Brief description of changes (1-2 sentences).

## Why

Motivation and context for this change.

Fixes #123 (link to issue if applicable)

## Testing

How to test these changes:

1. Step-by-step testing instructions
2. Expected behavior
3. Edge cases tested

## Checklist

- [ ] Tests added/updated (and passing)
- [ ] Documentation updated
- [ ] CHANGELOG.md updated
- [ ] Code follows style guide (Black + ruff)
- [ ] Type hints added (mypy passes)
- [ ] Commits are atomic and well-described
```

**Example PR description:**

```markdown
## What

Add `database_type` variable detection to IntentAnalyzer for automatic
database-specific template rendering.

## Why

Users creating projects with databases (PostgreSQL, MongoDB, etc.) need
database-specific setup instructions in generated README.md files.

Fixes #45

## Testing

1. Create project with goal: "Build API with PostgreSQL database"
2. Verify `intent.database_type == "postgresql"`
3. Check generated README.md includes PostgreSQL setup section
4. Test with MongoDB, MySQL, SQLite

**Edge cases:**
- Generic "database" mention ‚Üí returns "generic"
- No database ‚Üí returns None
- Multiple databases ‚Üí returns first detected

## Checklist

- [x] Tests added (test_intent_analyzer.py: 4 new tests)
- [x] Documentation updated (TEMPLATES.md, BEST_PRACTICES.md)
- [x] CHANGELOG.md updated (Added section)
- [x] Black + ruff pass
- [x] mypy passes
- [x] Atomic commits with conventional messages
```

### Review Process

**What to expect:**

1. **Automated checks:** GitHub Actions CI must pass
   - All tests passing
   - Code style (Black, ruff)
   - Type checking (mypy)
   - Coverage ‚â•90% for new code

2. **Maintainer review:** Within 2-3 business days
   - Code quality review
   - Architecture alignment
   - Documentation completeness
   - Test coverage

3. **Feedback:** Address reviewer comments
   - Make changes in new commits (don't force push)
   - Reply to comments when done
   - Re-request review

4. **Approval:** At least 1 maintainer approval required

5. **Merge:** Maintainer will squash and merge

**After merge:**
- Your branch will be deleted automatically
- Contribution appears in next release
- You're credited in CHANGELOG.md

---

## üìä Versioning Guidelines

### Dual Versioning System

The Claude Code Template uses **two independent version numbers**:

1. **Template Version:** `v3.0.0` (template structure, Jinja2 files, documentation)
2. **SDK Version:** `v1.0.0` (orchestrator/ Python code)

**Why separate versions?**
- Templates can change without SDK changes (new Jinja2 templates)
- SDK can evolve independently (new Pydantic models)
- Clear communication about what changed

### Semantic Versioning

Format: `MAJOR.MINOR.PATCH`

**MAJOR version** (breaking changes):
- Template structure changes (moving files, renaming directories)
- API changes in orchestrator (changing Pydantic model fields)
- Removing template variables
- Changing checkpoint behavior

**Examples:**
- ‚ùå `AutomationIntent.apis_list` changes from `List[str]` to `List[Dict]` ‚Üí MAJOR (4.0.0)
- ‚ùå Moving `.claude/templates/base/` to `.templates/` ‚Üí MAJOR (4.0.0)

**MINOR version** (new features, backward compatible):
- Adding new template variables
- Adding new Jinja2 templates
- New subagents
- New documentation

**Examples:**
- ‚úÖ Adding `database_type` variable ‚Üí MINOR (3.1.0)
- ‚úÖ New `@database-schema-analyzer` subagent ‚Üí MINOR (3.1.0)

**PATCH version** (bug fixes):
- Fixing template rendering bugs
- Correcting documentation typos
- Fixing Pydantic validation errors
- Performance improvements

**Examples:**
- ‚úÖ Fix Jinja2 escaping in README.md.j2 ‚Üí PATCH (3.0.1)
- ‚úÖ Fix checkpoint state not saving ‚Üí PATCH (3.0.1)

### Version Update Checklist

When releasing a new version:

```bash
# 1. Update CHANGELOG.md
## [3.1.0] - 2025-01-15
### Added
- Database type detection (#45)

# 2. Update version references in documentation
# - README.md (badges, version mentions)
# - CLAUDE.md (version in footer)
# - docs/USER_GUIDE.md (footer)
# - docs/BEST_PRACTICES.md (footer)

# 3. Commit version bump
git commit -m "chore: bump version to 3.1.0"

# 4. Create git tag
git tag -a v3.1.0 -m "Release 3.1.0: Database type detection"

# 5. Push tag to upstream
git push upstream main
git push upstream v3.1.0

# 6. GitHub release created automatically
# 7. Update main branch version to next development version
```

---

## üÜò Need Help?

### Getting Help

**Before asking:**
1. Read [Troubleshooting](docs/TROUBLESHOOTING.md)
2. Search [existing issues](https://github.com/iacorp/claude-code-template/issues)
3. Check [Discussions](https://github.com/iacorp/claude-code-template/discussions)

**How to ask:**

```markdown
**Environment:**
- OS: macOS 14.1
- Python: 3.11.5
- Template Version: 3.0.0

**What I'm trying to do:**
Add a new template variable for detecting API rate limits.

**What I've tried:**
1. Added field to AutomationIntent model
2. Updated IntentAnalyzer._detect_rate_limits()
3. Tests pass locally

**The problem:**
CI fails on GitHub Actions with Pydantic validation error.

**Error message:**
\`\`\`
ValidationError: 1 validation error for AutomationIntent
  rate_limit
    field required (type=value_error.missing)
\`\`\`

**Relevant code:**
[Link to branch or gist]
```

### Community Resources

- **GitHub Issues:** Bug reports and feature requests
- **GitHub Discussions:** Questions and community support
- **Discord:** Real-time chat (link in README.md)
- **Email:** maintainers@iacorp.com

---

## üìö Navigation

**Documentation Map:**

```
üöÄ QUICK_START.md     ‚Üê Start here
       ‚Üì
üìñ USER_GUIDE.md      ‚Üê Deep dive
       ‚Üì
üîß TROUBLESHOOTING.md ‚Üê Solve issues
       ‚Üì
‚ú® BEST_PRACTICES.md  ‚Üê Optimize
       ‚Üì
ü§ù CONTRIBUTING.md    ‚Üê Contribute (YOU ARE HERE)
```

**Quick Links:**

- [üè† Home](README.md) - Project overview
- [üöÄ Quick Start](QUICK_START.md) - 10-minute onboarding
- [üìñ User Guide](docs/USER_GUIDE.md) - Complete system documentation
- [‚ú® Best Practices](docs/BEST_PRACTICES.md) - Optimization guide
- [üîß Troubleshooting](docs/TROUBLESHOOTING.md) - Error solutions
- [üìã Planning](.claude/PLANNING.md) - Architecture details
- [üîÑ Changelog](CHANGELOG.md) - Version history

**External Resources:**

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Keep a Changelog](https://keepachangelog.com/)
- [Semantic Versioning](https://semver.org/)
- [GitHub Flow](https://guides.github.com/introduction/flow/)

---

**Thank you for contributing to Claude Code Template! üéâ**

Every contribution, no matter how small, makes this project better for everyone.

---

**Version:** 3.0.0 (M6 - Documentation)
**Last Updated:** 2025-01-03
**Status:** ‚úÖ Production Ready
**Maintainer:** IA Corp - Claude Code Template Team
